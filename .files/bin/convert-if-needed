#!/bin/bash

set -x
set -u

if [ $# -eq 0 ] ; then
   echo "usage: convert-if-needed <directory_path>"
   exit 0
fi

PARENT_DIR="${1}"

if [ ! -d "${PARENT_DIR}" ] ; then
   echo "directory does not exist: ${PARENT_DIR}"
   exit 0
fi

DWH_RAW_DIR="${PARENT_DIR}/raw-dwh"
MP4_RAW_DIR="${PARENT_DIR}/raw-mp4"
MOV_RAW_DIR="${PARENT_DIR}/raw-mov"

mkdir -p "${DWH_RAW_DIR}"
mkdir -p "${MP4_RAW_DIR}"
mkdir -p "${MOV_RAW_DIR}"

MY_PATH="`dirname \"$0\"`"
echo "MY_PATH: ${MY_PATH}"

${MY_PATH}/convert-dwh-if-needed \
   "${DWH_RAW_DIR}" \
   "${MP4_RAW_DIR}"

${MY_PATH}/convert-mp4-if-needed \
   "${MP4_RAW_DIR}" \
   "${MOV_RAW_DIR}"
